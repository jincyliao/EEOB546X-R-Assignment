---
title: "Jin(Ching-Yi Liao)'s R Notebook"
output: html_notebook
---
```{r}
setwd("/Users/user/R-Assignment")
```
#Part I

###*Data inspection*

**1. Load data files into R**

```{r}
Genotypes <- read.table("fang_et_al_genotypes.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
SNPposition <- read.table("snp_position.txt", header = TRUE, fill = TRUE, sep = "\t", stringsAsFactors = FALSE)
```
**2. Using R commands to perform data inspection**

For one example and the results R return:
```{r}
> typeof(Genotypes)
[1] "list"
> typeof(SNPposition)
[1] "list"
> class(Genotypes)
[1] "data.frame"
> class(SNPposition)
[1] "data.frame"
> ncol(Genotypes)
[1] 986
> ncol(SNPposition)
[1] 15
> nrow(Genotypes)
[1] 2782
> nrow(SNPposition)
[1] 983
```

Also try other commands:
```{r}
file.info("fang_et_al_genotypes.txt")
file.info("snp_position.txt")
str(Genotypes)
str(SNPposition)
colnames(Genotypes)
colnames(SNPposition)
rownames(Genotypes)
rownames(SNPposition)
head(Genotypes)
head(SNPposition)
```
###*Data processing*

**1. Extract data from the *Genotype* dataframe to make two objects:**
<br />(1) *Maize* (ZMMIL, ZMMLR, and ZMMMR)
<br />(2) *Teosinte* (ZMPBA, ZMPIL, and ZMPJA)

```{r}
Maize <- c("ZMMIL", "ZMMLR", "ZMMMR")
Teosinte <- c("ZMPBA", "ZMPIL", "ZMPJA")
MaizeGenotypes <- Genotypes[Genotypes$Group %in% Maize, ]
TeosinteGenotypes <- Genotypes[Genotypes$Group %in% Teosinte, ]
```

**2. Clean the useless columns in *MaizeGenotypes* and *TeosinteGenotypes* dataframes to get the names of the SNPs and the data.**

```{r}
MaizeGenotypes_cut <- MaizeGenotypes[,-1:-3]
TeosinteGenotypes_cut <- TeosinteGenotypes[,-1:-3]
```

**3. Clean the useless columns in *SNPposition* dataframe.**

```{r}
SNPposition_cut <- SNPposition[, c("SNP_ID","Chromosome","Position")]
```

**4. Transpose the *MaizeGenotypes_cut* and *TeosinteGenotypes_cut* dataframes.**

```{r}
MaizeGenotypes_transposed <- as.data.frame(t(MaizeGenotypes_cut))
TeosinteGenotypes_transposed <- as.data.frame(t(TeosinteGenotypes_cut))
```
**5. Make sure the two transposed files are dataframes.**

```{r}
> is.data.frame(MaizeGenotypes_transposed)
[1] TRUE
> is.data.frame(TeosinteGenotypes_transposed)
[1] TRUE
```
**6. Create a new *SNP_ID* column and delete the rownames created in the transposed files.**

```{r}
SNPsMaizeGenotypes_transposed <- cbind(SNP_ID = rownames(MaizeGenotypes_transposed), MaizeGenotypes_transposed)
rownames(SNPsMaizeGenotypes_transposed) <- NULL

SNPsTeosinteGenotypes_transposed <- cbind(SNP_ID = rownames(TeosinteGenotypes_transposed), TeosinteGenotypes_transposed)
rownames(SNPsTeosinteGenotypes_transposed) <- NULL
```

**7. Sort the *SNPposition_cut*, *SNPsMaizeGenotypes_transposed*, and *SNPsTeosinteGenotypes_transposed*.**

```{r}
SNPposition_sorted <- SNPposition_cut[order(SNPposition_cut$SNP_ID),] #sort by SNP_ID
Maize_sorted <- SNPsMaizeGenotypes_transposed[order(SNPsMaizeGenotypes_transposed$SNP_ID),] #sort by SNP_ID
Teosinte_sorted <- SNPsTeosinteGenotypes_transposed[order(SNPsTeosinteGenotypes_transposed$SNP_ID),] #sort by SNP_ID
```

**8. Check the rows in the files are all line up.**

```{r}
> table(SNPposition_sorted$SNP_ID %in% Maize_sorted$SNP_ID)

TRUE 
 983 
> table(SNPposition_sorted$SNP_ID %in% Teosinte_sorted$SNP_ID)

TRUE 
 983 
```
**9. Join the *SNPposition_sorted* dataframe to *Maize_sorted* and *Teosinte_sorted* by SNP_ID.**

```{r}
Maize_joined <- merge(SNPposition_sorted, Maize_sorted, by.x="SNP_ID", by.y="SNP_ID")
Teosinte_joined <- merge(SNPposition_sorted, Teosinte_sorted, by.x="SNP_ID", by.y="SNP_ID")
```
**10. Order the dataset based on increasing position values and with missing data encoded by symbol *?* **

```{r}
MaizeIncrease_ordered <- Maize_joined[mixedorder(Maize_joined$Position),] 
TeosinteIncrease_ordered <- Teosinte_joined[mixedorder(Teosinte_joined$Position),]
```
```{r}
MaizeChr1 <- MaizeIncrease_ordered[MaizeIncrease_ordered$Chromosome == 1,]
write.table(MaizeChr1, "MaizeChr1.txt", sep="\t", row.names = FALSE) 
```
(Repeat for each chromosome.)
```{r}
TeosinteChr1 <- TeosinteIncrease_ordered[TeosinteIncrease_ordered$Chromosome == 1,]
write.table(TeosinteChr1, "TeosinteChr1.txt", sep="\t", row.names = FALSE)
```
(Repeat for each chromosome.)

**11. Order the dataset based on decreasing position values and with missing data encoded by symbol - **
```{r}
Maize_missing <- as.data.frame(lapply(Maize_joined, function(x) {gsub("\\?","-", x)})) # missing data replaced with symbol -
Teosinte_missing <- as.data.frame(lapply(Teosinte_joined, function(x) {gsub("\\?","-", x)})) # missing data replaced with symbol -
```
```{r}
MaizeDecrease_ordered <- Maize_missing[mixedorder(as.character(Maize_missing$Position), decreasing=TRUE),] 
TeosinteDecrease_ordered <- Teosinte_missing[mixedorder(as.character(Teosinte_missing$Position), decreasing=TRUE),]
```
```{r}
MaizeChr1_d <- MaizeDecrease_ordered[MaizeDecrease_ordered$Chromosome == 1,]
write.table(MaizeChr1_d, "MaizeChr1_d.txt", sep="\t", row.names = FALSE)
```
(Repeat for each chromosome.)
```{r}
TeosinteChr1_d <- TeosinteDecrease_ordered[TeosinteDecrease_ordered$Chromosome == 1,]
write.table(TeosinteChr1_d, "TeosinteChr1_d.txt", sep="\t", row.names = FALSE)
```
(Repeat for each chromosome.)

#Part II

###*SNPs per chromosome*

###*Missing data and amount of heterozygosity*

###*My own visualization*

